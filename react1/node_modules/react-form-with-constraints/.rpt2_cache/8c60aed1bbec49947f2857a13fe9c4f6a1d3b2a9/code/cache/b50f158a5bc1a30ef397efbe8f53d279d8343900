{"code":"import * as tslib_1 from \"tslib\";\r\nimport * as React from 'react';\r\nimport * as PropTypes from 'prop-types';\r\nvar FieldFeedback = (function (_super) {\r\n    tslib_1.__extends(FieldFeedback, _super);\r\n    function FieldFeedback(props, context) {\r\n        var _this = _super.call(this, props) || this;\r\n        _this.validate = _this.validate.bind(_this);\r\n        _this.key = context.fieldFeedbacks.computeFieldFeedbackKey();\r\n        return _this;\r\n    }\r\n    FieldFeedback.prototype.componentWillMount = function () {\r\n        this.context.fieldFeedbacks.addValidateEventListener(this.validate);\r\n    };\r\n    FieldFeedback.prototype.componentWillUnmount = function () {\r\n        this.context.fieldFeedbacks.removeValidateEventListener(this.validate);\r\n    };\r\n    FieldFeedback.prototype.validate = function (input) {\r\n        var _a = this.props, when = _a.when, warning = _a.warning, info = _a.info;\r\n        var fieldName = this.context.fieldFeedbacks.props.for;\r\n        var show = false;\r\n        if (typeof when === 'function') {\r\n            var constraintViolation = when(input.value);\r\n            if (constraintViolation) {\r\n                show = true;\r\n            }\r\n        }\r\n        else if (typeof when === 'string') {\r\n            var validity = input.validity;\r\n            if (!validity.valid) {\r\n                if (when === '*') {\r\n                    show = true;\r\n                }\r\n                else if (validity.badInput && when === 'badInput' ||\r\n                    validity.patternMismatch && when === 'patternMismatch' ||\r\n                    validity.rangeOverflow && when === 'rangeOverflow' ||\r\n                    validity.rangeUnderflow && when === 'rangeUnderflow' ||\r\n                    validity.stepMismatch && when === 'stepMismatch' ||\r\n                    validity.tooLong && when === 'tooLong' ||\r\n                    validity.tooShort && when === 'tooShort' ||\r\n                    validity.typeMismatch && when === 'typeMismatch' ||\r\n                    validity.valueMissing && when === 'valueMissing') {\r\n                    show = true;\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            console.assert(false, \"Invalid FieldFeedback 'when': \" + when);\r\n        }\r\n        var field = this.context.form.fieldsStore.cloneField(fieldName);\r\n        field.dirty = true;\r\n        field.validationMessage = input.validationMessage;\r\n        if (show) {\r\n            if (warning)\r\n                field.warnings.add(this.key);\r\n            else if (info)\r\n                field.infos.add(this.key);\r\n            else\r\n                field.errors.add(this.key);\r\n        }\r\n        this.context.form.fieldsStore.updateField(fieldName, field);\r\n    };\r\n    FieldFeedback.prototype.render = function () {\r\n        var _a = this.props, when = _a.when, error = _a.error, warning = _a.warning, info = _a.info, className = _a.className, children = _a.children, divProps = tslib_1.__rest(_a, [\"when\", \"error\", \"warning\", \"info\", \"className\", \"children\"]);\r\n        var _b = this.context.fieldFeedbacks.props, fieldName = _b.for, show = _b.show;\r\n        var _c = this.context.form.fieldsStore.getFieldFor(fieldName, this.context.fieldFeedbacks.key), errors = _c.errors, warnings = _c.warnings, infos = _c.infos, validationMessage = _c.validationMessage;\r\n        var firstError = errors.values().next().value;\r\n        var firstWarning = warnings.values().next().value;\r\n        var classes;\r\n        if (errors.has(this.key) && (show === 'all' || (show === 'first' && firstError === this.key))) {\r\n            classes = 'error';\r\n        }\r\n        else if (warnings.has(this.key) && (errors.size === 0 && (show === 'all' || (show === 'first' && firstWarning === this.key)))) {\r\n            classes = 'warning';\r\n        }\r\n        else if (infos.has(this.key)) {\r\n            classes = 'info';\r\n        }\r\n        var feedback = null;\r\n        if (classes !== undefined) {\r\n            classes = className !== undefined ? className + \" \" + classes : classes;\r\n            feedback = children !== undefined ? children : validationMessage;\r\n        }\r\n        return feedback !== null ? React.createElement(\"div\", tslib_1.__assign({}, divProps, { className: classes }), feedback) : null;\r\n    };\r\n    FieldFeedback.contextTypes = {\r\n        form: PropTypes.object.isRequired,\r\n        fieldFeedbacks: PropTypes.object.isRequired\r\n    };\r\n    return FieldFeedback;\r\n}(React.Component));\r\nexport { FieldFeedback };\r\n//# sourceMappingURL=FieldFeedback.js.map","map":{"version":3,"file":"FieldFeedback.js","sourceRoot":"","sources":["FieldFeedback.tsx"],"names":[],"mappings":"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"}}
